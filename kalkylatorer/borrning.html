<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Skärdatakalkylator - Borrning (HM & HSS)</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* CSS-STYLING FÖR DENNA KALKYLATOR */
        :root {
            --bg: #f8fafc; --card: #ffffff; --text: #1e293b; --text-light: #64748b;
            --primary: #3b82f6; --primary-light: #dbeafe; --success: #10b981; 
            --warning: #f59e0b; --danger: #ef4444; --border: #e2e8f0; 
            --shadow: 0 20px 40px rgba(0,0,0,0.08); --radius: 16px;
        }
        @media (prefers-color-scheme: dark) {
            :root { --bg: #0f172a; --card: #1e293b; --text: #f1f5f9; --text-light: #94a3b8;
                    --border: #334155; --shadow: 0 20px 40px rgba(0,0,0,0.4); }
        }
        body.dark { --bg: #0f172a; --card: #1e293b; --text: #f1f5f9; --text-light: #94a3b8;
                    --border: #334155; --shadow: 0 20px 40px rgba(0,0,0,0.4); }
        
        * { margin:0; padding:0; box-sizing:border-box; }
        body { font-family:'Inter',sans-serif; background:var(--bg); color:var(--text); padding:0; transition:all .4s; }
        .container { max-width:560px; margin:0 auto; background:var(--card); padding: 0; box-shadow:none; border-radius: 0;}
        header { background:linear-gradient(135deg,#667eea,#764ba2); color:white; padding:30px 24px; text-align:center; position:relative; }
        h1 { font-size:1.8rem; font-weight:700; margin-bottom:8px; }
        .subtitle { font-size:0.9rem; opacity:0.9; }
        main { padding:32px 24px; }

        /* TOOL BADGE */
        .tool-badge { position:absolute; top:16px; left:16px; padding:6px 14px;
                      border-radius:50px; font-size:0.8rem; font-weight:700;
                      text-transform:uppercase; letter-spacing:0.5px; }
        .tool-hm { background:#1d4ed8; } .tool-hss { background:#ea580c; }
        
        /* FORM STYLING */
        .form-group { margin-bottom: 24px; }
        label { display:block; margin-bottom:8px; font-weight:600; font-size:0.95rem; }
        select, input[type=number] { width:100%; padding:14px 16px; border:2px solid var(--border);
            border-radius:12px; background:var(--card); color:var(--text); font-size:1rem;
            transition:all .3s; }
        select:focus, input[type=number]:focus { border-color:var(--primary); outline:none; }
        
        /* RESULTS STYLING */
        .results { 
            background: var(--primary-light); 
            padding: 24px; 
            border-radius: 12px; 
            margin-top: 32px; 
            color: var(--text);
            transition: background .4s;
        }
        body.dark .results { 
            background: #1e3a8a; 
            color: white;
        }
        .results h2 { 
            font-size: 1.4rem; 
            font-weight: 700; 
            margin-bottom: 16px; 
            color: var(--primary); 
            transition: color .4s;
        }
        body.dark .results h2 { color: #93c5fd; }
        .result-line { 
            display: flex; 
            justify-content: space-between; 
            font-size: 1.1rem; 
            font-weight: 600; 
            padding: 8px 0;
            border-bottom: 1px solid rgba(0,0,0,0.1);
        }
        body.dark .result-line { border-bottom: 1px solid rgba(255,255,255,0.1); }
        .result-line:last-of-type { border-bottom: none; margin-bottom: 8px; }
        .value { color: var(--text); font-weight: 700; }
        .value.capped { color: var(--danger); }
        .details { 
            margin-top: 16px; 
            padding-top: 12px; 
            border-top: 1px solid var(--border); 
            font-size: 0.85rem; 
            color: var(--text-light);
        }
        .details p { margin-bottom: 4px; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <div class="tool-badge tool-hm" id="toolBadge">HM</div>
        <h1>Skärdatakalkylator</h1>
        <p class="subtitle">Borrning – Hårdmetall & Snabbstål (0.5–25 mm)</p>
    </header>

    <main>
        <div class="form-group">
            <label for="toolType">Verktygsmaterial</label>
            <select id="toolType">
                <option value="HM">Hårdmetall (HM)</option>
                <option value="HSS">Snabbstål (HSS)</option>
            </select>
        </div>

        <div class="form-group">
            <label for="material">Materialgrupp</label>
            <select id="material">
                <option value="P1">Stål - Olegerat</option>
                <option value="P3">Stål - Seghärdat</option>
                <option value="M1">Rostfritt - Martensitiskt</option>
                <option value="K1">Gjutjärn - Gråjärn</option>
                <option value="N1">Icke-järn - Aluminium</option>
                <option value="S2">Högtemp - Titanlegeringar</option>
            </select>
        </div>

        <div class="form-group">
            <label for="length">Borrdjup/Diameter-kvot (L/D)</label>
            <select id="length">
                <option value="2D">Kort (L/D < 3)</option>
                <option value="4D">Standard (3 < L/D < 5)</option>
                <option value="6D">Lång (L/D > 5)</option>
            </select>
        </div>

        <div class="form-group">
            <label for="diameter">Diameter (D, mm)</label>
            <input type="number" id="diameter" value="6.0" min="0.5" max="25" step="0.5">
        </div>

        <div class="form-group">
            <label for="maxRpm">Maskinens max RPM</label>
            <input type="number" id="maxRpm" value="10000" min="1000" step="1000">
        </div>

        <div class="results" id="results">
            <p style="color:var(--text-light); text-align:center; padding:20px 0;">
                Fyll i fälten ovan för att få skärdata
            </p>
        </div>
    </main>
</div>

<script>
    // JS-LOGIK
    const materialDataHM = {
        P1: { Vc: 120, Fn_2D: 0.15, Fn_4D: 0.12, Fn_6D: 0.10, name: "Stål - Olegerat" },
        P3: { Vc: 80, Fn_2D: 0.10, Fn_4D: 0.08, Fn_6D: 0.07, name: "Stål - Seghärdat" },
        M1: { Vc: 60, Fn_2D: 0.10, Fn_4D: 0.08, Fn_6D: 0.06, name: "Rostfritt" },
        K1: { Vc: 150, Fn_2D: 0.20, Fn_4D: 0.15, Fn_6D: 0.12, name: "Gjutjärn" },
        N1: { Vc: 200, Fn_2D: 0.30, Fn_4D: 0.25, Fn_6D: 0.20, name: "Aluminium" },
        S2: { Vc: 30, Fn_2D: 0.06, Fn_4D: 0.05, Fn_6D: 0.04, name: "Titanlegeringar" },
    };

    const materialDataHSS = {
        P1: { Vc: 40, Fn_2D: 0.12, Fn_4D: 0.10, Fn_6D: 0.08, name: "Stål - Olegerat" },
        P3: { Vc: 30, Fn_2D: 0.08, Fn_4D: 0.07, Fn_6D: 0.06, name: "Stål - Seghärdat" },
        M1: { Vc: 15, Fn_2D: 0.06, Fn_4D: 0.05, Fn_6D: 0.04, name: "Rostfritt" },
        K1: { Vc: 50, Fn_2D: 0.15, Fn_4D: 0.12, Fn_6D: 0.10, name: "Gjutjärn" },
        N1: { Vc: 80, Fn_2D: 0.20, Fn_4D: 0.15, Fn_6D: 0.12, name: "Aluminium" },
        S2: { Vc: 10, Fn_2D: 0.04, Fn_4D: 0.03, Fn_6D: 0.03, name: "Titanlegeringar" },
    };

    // Fd (Diameterfaktor) för att justera matningen (fz) baserat på diameter (D)
    function interpolateFd(D, lengthType, toolType) {
        // Enklare interpolation för borrning: Ju mindre D, desto lägre Fn
        if (D <= 3.0) return 0.7;
        if (D <= 6.0) return 0.85;
        if (D <= 10.0) return 0.95;
        return 1.0;
    }

    function calculateCuttingData() {
        const toolType = document.getElementById('toolType').value;
        const matKey = document.getElementById('material').value;
        const lengthType = document.getElementById('length').value;
        const D = parseFloat(document.getElementById('diameter').value);
        const maxRpm = parseFloat(document.getElementById('maxRpm').value);

        if (!(D > 0 && maxRpm > 0 && D >= 0.5 && D <= 25)) {
            document.getElementById('results').innerHTML = `<p style="color:var(--danger); text-align:center; padding:20px 0;">Kontrollera Diameter (0.5-25 mm) och Max RPM</p>`;
            document.getElementById('toolBadge').className = `tool-badge tool-${toolType.toLowerCase()}`;
            return;
        }

        const dataSet = toolType === 'HM' ? materialDataHM : materialDataHSS;
        const mat = dataSet[matKey];
        const Vc = mat.Vc;
        
        // Hämta fz (matning per varv) baserat på borrdjup
        const Fn_base = mat[`Fn_${lengthType}`] || mat.Fn_2D;
        
        // Diameterfaktor
        const Fd = interpolateFd(D, lengthType, toolType);
        
        // Final Fn (matning per varv)
        const Fn = Fn_base * Fd;

        // 1. Varvtal (n)
        let n = (Vc * 1000) / (Math.PI * D);
        let n_final = n;
        let capped = false;

        if (n > maxRpm) {
            n_final = maxRpm;
            capped = true;
        }

        // 2. Bordmatning (Vf)
        const Vf_final = n_final * Fn;

        // Uppdatera badge
        document.getElementById('toolBadge').className = `tool-badge tool-${toolType.toLowerCase()}`;
        
        // Visa resultat
        document.getElementById('results').innerHTML = `
            <h2>${toolType} – Skärdata</h2>
            <div class="result-line"><strong>Varvtal (n)</strong> 
                <span class="value ${capped?'capped':''}">${n_final.toLocaleString('sv', { maximumFractionDigits: 0 })} varv/min${capped?' *':''}</span>
            </div>
            <div class="result-line"><strong>Bordmatning (Vf)</strong> 
                <span class="value">${Vf_final.toLocaleString('sv', { maximumFractionDigits: 0 })} mm/min</span>
            </div>
            ${capped ? '<p class="warning-text" style="color: var(--danger); margin: 8px 0;">* Begränsat av maskinens max-RPM</p>' : ''}
            <div class="details">
                <p><strong>Material:</strong> ${mat.name}</p>
                <p><strong>fz (Matning/varv):</strong> ${Fn.toFixed(3)} mm</p>
                <p><strong>Skärhastighet (Vc):</strong> ${Vc} m/min</p>
                <p><strong>Diameterfaktor (Fd):</strong> ${Fd.toFixed(4)}</p>
            </div>
        `;
    }

    // Lyssnare på alla fält
    document.querySelectorAll('#toolType, #material, #length, #diameter, #maxRpm').forEach(el => {
        el.addEventListener('input', calculateCuttingData);
        el.addEventListener('change', calculateCuttingData);
    });

    // Anropa vid start för att visa defaultvärden
    document.addEventListener('DOMContentLoaded', calculateCuttingData);
    
    // Den gamla TEMALOGIKEN är BORTTAGEN HÄR
</script>
</body>
</html>
